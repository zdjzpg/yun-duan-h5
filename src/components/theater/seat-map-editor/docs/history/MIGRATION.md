# åº§ä½å›¾ç¼–è¾‘å™¨é‡æ„ - é˜¶æ®µ 1 è¿ç§»è¯´æ˜

## ğŸ“‹ **é‡æ„æ¦‚è§ˆ**

æœ¬æ¬¡é‡æ„åŸºäº**æ–¹æ¡ˆ Gï¼šä¸“ä¸šå‰§åœºåº§ä½å›¾ç¼–è¾‘å™¨**ï¼Œå°†ä¼ ç»Ÿåå°å¸ƒå±€å‡çº§ä¸ºä¸“ä¸šçº§ç¼–è¾‘å™¨å¸ƒå±€ã€‚

---

## ğŸ”„ **æ•°æ®ç»“æ„å˜æ›´**

### **æ–°å¢ç±»å‹**

```typescript
// æ–°å¢ï¼šæ¥¼å±‚æ•°æ®
export type Floor = {
  id: string;
  name: string;          // '1F', '2F', '3F'
  level: number;         // æ¥¼å±‚é¡ºåº
  zones: Zone[];         // è¯¥æ¥¼å±‚çš„åº§åŒº
  aisles: Aisle[];       // èµ°é“
  stage?: Stage;         // èˆå°ï¼ˆå¯é€‰ï¼‰
};

// æ–°å¢ï¼šèµ°é“æ•°æ®
export type Aisle = {
  id: string;
  floorId: string;
  name: string;
  type: 'horizontal' | 'vertical';
  x: number;
  y: number;
  width: number;
  height: number;
  color?: string;
};

// æ–°å¢ï¼šèˆå°æ•°æ®
export type Stage = {
  id: string;
  floorId: string;
  name: string;
  x: number;
  y: number;
  width: number;
  height: number;
  direction: 'top' | 'bottom' | 'left' | 'right';
  color?: string;
};

// æ–°å¢ï¼šç¼–è¾‘å·¥å…·ç±»å‹
export type Tool =
  | 'select'    // é€‰æ‹©å·¥å…·
  | 'zone'      // åº§åŒºå·¥å…·
  | 'row'       // æ’åº§å·¥å…·
  | 'seat'      // åº§ä½å·¥å…·
  | 'aisle'     // èµ°é“å·¥å…·
  | 'stage'     // èˆå°å·¥å…·
  | 'pan';      // å¹³ç§»å·¥å…·
```

### **æ‰©å±•ç±»å‹**

```typescript
// Zone æ–°å¢å­—æ®µ
export type Zone = {
  // ... åŸæœ‰å­—æ®µ
  floorId: string;       // ğŸ†• æ‰€å±æ¥¼å±‚
  rotation?: number;     // ğŸ†• æ—‹è½¬è§’åº¦
};

// SelectedElement æ–°å¢ç±»å‹
export type SelectedElement =
  | { type: 'floor'; id: string }    // ğŸ†•
  | { type: 'aisle'; id: string }    // ğŸ†•
  | { type: 'stage'; id: string }    // ğŸ†•
  // ... åŸæœ‰ç±»å‹
  | null;
```

### **åºŸå¼ƒç±»å‹**

```typescript
/**
 * @deprecated ä½¿ç”¨ Tool æ›¿ä»£
 */
export type EditorMode = 'select' | 'add-zone' | 'add-row' | 'edit-seat' | 'delete';
```

---

## ğŸ—ï¸ **ç»„ä»¶å˜æ›´**

### **æ–°å¢ç»„ä»¶**

| ç»„ä»¶ | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| **LeftToolbar** | `LeftToolbar.tsx` | å·¦ä¾§å·¥å…·æ ï¼ˆå·¥å…·åˆ‡æ¢ï¼‰ |
| **TopToolbar** | `TopToolbar.tsx` | é¡¶éƒ¨å¯¹é½å·¥å…·æ  |
| **RightPanel** | `RightPanel.tsx` | å³ä¾§åŠ¨æ€å±æ€§é¢æ¿ |
| **BottomStatusBar** | `BottomStatusBar.tsx` | åº•éƒ¨çŠ¶æ€æ ï¼ˆæ¥¼å±‚åˆ‡æ¢ã€ç»Ÿè®¡ï¼‰ |
| **TheaterCanvas** | `TheaterCanvas.tsx` | å‰§åœºç”»å¸ƒï¼ˆæ”¯æŒå¤šæ¥¼å±‚ï¼‰ |

### **ä¿ç•™ç»„ä»¶**

| ç»„ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **ZonePanel** | âœ… å…¼å®¹ | æ— éœ€ä¿®æ”¹ |
| **RowPanel** | âœ… å…¼å®¹ | æ— éœ€ä¿®æ”¹ |
| **SeatEditPanel** | âœ… å…¼å®¹ | æ— éœ€ä¿®æ”¹ |

### **åºŸå¼ƒç»„ä»¶**

| ç»„ä»¶ | åŸè·¯å¾„ | æ›¿ä»£æ–¹æ¡ˆ |
|------|--------|---------|
| ~~Toolbar~~ | `Toolbar.tsx` | åŠŸèƒ½æ‹†åˆ†åˆ° LeftToolbar + TopToolbar |
| ~~SeatMapCanvas~~ | `SeatMapCanvas.tsx` | ä½¿ç”¨ TheaterCanvas |

---

## ğŸ“ **å¸ƒå±€å˜æ›´**

### **æ—§ç‰ˆå¸ƒå±€ï¼ˆé˜¶æ®µ 0ï¼‰**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å·¥å…·æ ] æ¨¡å¼åˆ‡æ¢ + æ“ä½œæŒ‰é’® + ç»Ÿè®¡ä¿¡æ¯                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚                     â”‚
â”‚        SeatMapCanvas             â”‚   SeatEditPanel     â”‚
â”‚        (18 Col)                  â”‚   (6 Col)           â”‚
â”‚                                  â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **æ–°ç‰ˆå¸ƒå±€ï¼ˆé˜¶æ®µ 1ï¼‰**

```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚    â”‚ [é¡¶éƒ¨å¯¹é½å·¥å…·æ ] å¯¹é½ã€åˆ†å¸ƒã€åˆ é™¤          â”‚    â”‚
â”‚ å·¦ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ å³ â”‚
â”‚ ä¾§ â”‚                                            â”‚ ä¾§ â”‚
â”‚ å·¥ â”‚          TheaterCanvas                     â”‚ å± â”‚
â”‚ å…· â”‚          (å¤šæ¥¼å±‚ç”»å¸ƒ)                      â”‚ æ€§ â”‚
â”‚ æ  â”‚                                            â”‚ é¢ â”‚
â”‚    â”‚                                            â”‚ æ¿ â”‚
â”œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¤
â”‚ [åº•éƒ¨çŠ¶æ€æ ] æ¥¼å±‚åˆ‡æ¢ | åæ ‡ | ç¼©æ”¾ | ç»Ÿè®¡            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ **API å˜æ›´**

### **SeatMapEditor Props**

#### **å…¼å®¹æ€§**

```typescript
// âœ… æ—§ç‰ˆæ•°æ®æ ¼å¼ä¾ç„¶æ”¯æŒ
<SeatMapEditor
  initialData={{
    zones: [...],
    rows: [...],
    seats: [...]
  }}
/>

// âœ… æ–°ç‰ˆæ•°æ®æ ¼å¼
<SeatMapEditor
  initialData={{
    floors: [{
      id: '...',
      name: '1F',
      zones: [...],
      aisles: [...],
      stage: {...}
    }],
    rows: [...],
    seats: [...]
  }}
/>
```

#### **onChange å›è°ƒ**

```typescript
// âš ï¸ å›è°ƒæ•°æ®æ ¼å¼å·²å‡çº§ä¸º TheaterData
onChange?: (data: TheaterData) => void;

// TheaterData ç»“æ„
{
  id: string;
  name: string;
  floors: Floor[];
  rows: Row[];
  seats: Seat[];
  metadata: {
    createdAt: string;
    updatedAt: string;
  };
}
```

---

## âš¡ **åŠŸèƒ½å˜æ›´**

### **æ–°å¢åŠŸèƒ½**

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| å¤šæ¥¼å±‚æ”¯æŒ | âœ… å·²å®ç° | åº•éƒ¨çŠ¶æ€æ åˆ‡æ¢æ¥¼å±‚ |
| å·¥å…·åˆ‡æ¢ | âœ… å·²å®ç° | å·¦ä¾§å·¥å…·æ  7 ç§å·¥å…· |
| ç¼©æ”¾æ§åˆ¶ | âœ… å·²å®ç° | åº•éƒ¨çŠ¶æ€æ  +/- æŒ‰é’® |
| å®æ—¶åæ ‡ | âœ… å·²å®ç° | é¼ æ ‡ç§»åŠ¨æ˜¾ç¤ºåæ ‡ |
| åŠ¨æ€å±æ€§é¢æ¿ | âœ… å·²å®ç° | æ ¹æ®é€‰ä¸­å¯¹è±¡æ˜¾ç¤ºä¸åŒå±æ€§ |
| å¯¹é½å·¥å…·æ  | âœ… å·²å®ç° | é¡¶éƒ¨å¯¹é½ã€åˆ†å¸ƒæŒ‰é’®ï¼ˆUI onlyï¼‰ |

### **é˜¶æ®µ 2 å¾…å®ç°**

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|-------|------|
| æ‹–æ‹½ç»˜åˆ¶åº§åŒº | P0 | ç‚¹å‡»åº§åŒºå·¥å…·ååœ¨ç”»å¸ƒä¸Šæ‹–æ‹½ |
| èµ°é“ç»˜åˆ¶ | P0 | ç‚¹å‡»èµ°é“å·¥å…·ååœ¨ç”»å¸ƒä¸Šæ‹–æ‹½ |
| èˆå°æ·»åŠ  | P0 | ç‚¹å‡»èˆå°å·¥å…·ååœ¨ç”»å¸ƒä¸Šæ‹–æ‹½ |
| å¯¹é½åŠŸèƒ½å®ç° | P1 | å®ç°é¡¶éƒ¨å·¥å…·æ çš„å¯¹é½é€»è¾‘ |

---

## ğŸ“ **ä½¿ç”¨ç¤ºä¾‹**

### **åŸºç¡€ç”¨æ³•**

```tsx
import { SeatMapEditor } from '@/components/theater/seat-map-editor';

export default function VenueEditPage() {
  const [theaterData, setTheaterData] = useState<TheaterData>();

  return (
    <SeatMapEditor
      initialData={theaterData}
      onChange={(data) => {
        console.log('åº§ä½å›¾æ›´æ–°:', data);
        setTheaterData(data);
      }}
    />
  );
}
```

### **å¤šæ¥¼å±‚åˆå§‹åŒ–**

```tsx
const initialData: TheaterData = {
  id: 'theater_001',
  name: 'å¤§å‰§é™¢',
  floors: [
    {
      id: 'floor_1',
      name: '1F',
      level: 1,
      zones: [],
      aisles: [],
    },
    {
      id: 'floor_2',
      name: '2F',
      level: 2,
      zones: [],
      aisles: [],
      stage: {
        id: 'stage_1',
        floorId: 'floor_2',
        name: 'ä¸»èˆå°',
        x: 400,
        y: 100,
        width: 400,
        height: 200,
        direction: 'bottom',
      },
    },
  ],
  rows: [],
  seats: [],
};

<SeatMapEditor initialData={initialData} />
```

---

## âš ï¸ **æ³¨æ„äº‹é¡¹**

1. **æ•°æ®å…¼å®¹æ€§**ï¼šæ—§ç‰ˆæ•°æ®ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæ–°ç‰ˆæ ¼å¼ï¼Œä½†å»ºè®®é€æ­¥è¿ç§»æ•°æ®ç»“æ„
2. **å·¥å…·åŠŸèƒ½**ï¼šéƒ¨åˆ†å·¥å…·ï¼ˆåº§åŒºã€èµ°é“ã€èˆå°ï¼‰åœ¨é˜¶æ®µ 1 ä»…æ˜¾ç¤º UIï¼Œç‚¹å‡»ä¼šæç¤º"é˜¶æ®µ 2 å®ç°"
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šå¤§é‡åº§ä½æ¸²æŸ“æ—¶å»ºè®®ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆé˜¶æ®µ 3 ä¼˜åŒ–ï¼‰
4. **å¿«æ·é”®**ï¼šå¿«æ·é”®åŠŸèƒ½å°†åœ¨é˜¶æ®µ 3 å®ç°

---

## ğŸš€ **ä¸‹ä¸€æ­¥**

- âœ… **é˜¶æ®µ 1 å®Œæˆ**ï¼šåŸºç¡€é‡æ„
- â³ **é˜¶æ®µ 2**ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆæ‹–æ‹½ç»˜åˆ¶ã€èµ°é“ã€èˆå°ï¼‰
- â³ **é˜¶æ®µ 3**ï¼šäº¤äº’ä¼˜åŒ–ï¼ˆå¿«æ·é”®ã€æ’¤é”€é‡åšï¼‰
- â³ **é˜¶æ®µ 4**ï¼šé«˜çº§åŠŸèƒ½ï¼ˆ3D é¢„è§ˆã€æ¨¡æ¿åº“ï¼‰

---

**æ›´æ–°æ—¶é—´ï¼š** 2025-12-14  
**ç‰ˆæœ¬ï¼š** v2.0.0 (é˜¶æ®µ 1)
